# 文件系统

文件系统为用户提供了在计算机系统中对数据信息进行长期、大量存储和访问对功能。

## 文件

### 文件命名

所有操作系统都允许用1-8个字母组成的字符串作为文件名。
多数操作系统都支持文件名用圆点隔开氛围两部分，圆点后面的部分分为文件扩展名。

### 文件结构

1. 无结构字节序列

无结构字节序列也称为流式文件. 操作系统不知道也不关心文件内容是什么，操作系统所见到的就是字节。

2. 固定长度记录序列

构成文件的基本单位是具有固定长度的记录，每个记录都有其内部结构。把文件作为记录序列的中心思想是：读操作返回一个记录，而写操作重新或者追加一个记录。


3. 树形结构

文件由一棵记录树构成，记录长度不定，在记录的固定位置包含一个关键字域.记录树按关键字域排序。

### 文件类型

文件的类型有正规文件、目录文件、字符设备文件和块设备文件等。

正规文件包含用户信息，一般分为ASCII文件和二进制文件。

目录文件用于管理文件的系统文件。

字符设备文件和输入输出有关，用于串行I/O类设备。

1. ASCII （Amercian Standard Code for Information Interchange）文件

ASCII文件由多行正文组成, 在某些系统中每行用回车符结束， 某些则用换行符结束，而有些系统还同时采用回车符和换行符。
ASCII文件的明显优势是可以显示和打印，也可以用通常的文本编辑器进行编辑。

2. 二进制文件

具有一定的内部结构，如可执行的.exe 文件。 必须用专门的二进制文件编辑器，不同的操作系统可以识别不同的二进制文件。

### 文件存取

用户通过对文件对存取来完成对文件对各种操作，文件对存取方式是由文件对性质和用户使用文件对情况确定的。常用的文件存取方式由两种，顺序存取和随机存取。

1. 顺序存取

早起的操作系统只有顺序存取这一种文件存取方式。进程可以从文件开始处读取文件中的所有字节或记录，但不能跳过某些内容，也不能不按顺序存取。

2. 随机存取

随机存取又称直接存取，即可以以任意顺序读取文件中但字节或者记录。现代操作系统的文件一旦被创建，所有文件自动成为随机存取文件。定长记录的文件能很好地支持随机存取，而变长记录虽然可以随机存取，但实现起来复杂而且存取速度慢。


### 文件属性

为方便管理，除了文件名和文件数据外，文件系统还会保存其他与文件相关的信息，如文件的创建日期，文件大小和修改时间等，这些附加信息成为文件属性。

文件属性在不同操作系统中差别很大。

### 文件操作

使用文件等目的是存储信息并方便以后检索。 不同的系统提供了不同的操作来存储和检索信息。

1. CREATE 

该操作完成创建文件的功能，并设置文件的一些属性。

2. DELETE

当不再需要某个文件时，删除该文件并释放磁盘空间。

3. OPEN

在使用文件之前，必须先打开文件。 OPEN 调用的目的是将文件属性和文件的地址信息装入主存，便于在对文件的后续访问中能快速存取文件信息。

4. CLOSE

当存取结束后，不再需要文件属性和地址信息，这时应该关闭文件以释放内部表空间。很多系统限制进程打开文件的个数，以鼓励用户关闭不再使用的文件。

5. READ

从文件中读取数据。 一般地，用户可以指定从哪个文件的第几个字节开始读取多少个字节的内容。

6. WRITE

从文件中写数据，写操作一般从写函数的参数指定的文件位置开始。如果当前位置是文件末尾，文件长度增加。如果当前位置在文件中间，则现有数据被覆盖，并且永远丢失。

7. APPEND

该操作是WRITE调用的限制形式，它只能在文件末尾添加数据。

8. SEEK

对于随机存取文件，要指定从何处开始取数据。 通常的做法是用 SEEK 系统调用把当前位置指针指向文件中特定的位置。SEEK调用结束后，就可以从该位置读写数据了。

9. GETATTRIBUTES

该操作用于获取文件属性。

10. SETATTRIBUTES

某些属性是可由用户设置的，文件创建以后，用户还可以通过系统调用SETATTRIBUTES 来修改它们。

11. RENAME

该操作用于修改已有文件的文件名。


## 目录

文件系统通常提供目录或文件夹用于记录文件，很多系统中目录本身也是文件，目录是文件系统中实现按名访问文件的重要数据结构。

### 层次目录系统

1. 目录文件的结构

目录文件由两种常见的结构：属性放在目录项中和放在i结点中。
文件目录包含许多目录项，每个目录项用于描述一个文件。

在第一种结构中，每个目录项长度相同，每个文件对应一个目录项。 其中包含文件名、文件属性和文件的地址。

在第二种结构中，目录项中有一个文件名和i结点号。 i结点是一种数据结构，文件属性和文件的地址信息存放在i结点中。
